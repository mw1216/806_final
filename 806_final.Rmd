---
title: "806_final"
author: "Megan Worth"
date: "11/8/2021"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo = FALSE}

sup_data <- read.csv("C:/Users/megan/Desktop/806_final/supp_data1.csv", stringsAsFactors = TRUE)

lake_data <- read.csv("C:/Users/megan/Desktop/806_final/lake_data1.csv", stringsAsFactors = TRUE)

otu_data <- read.csv("C:/Users/megan/Desktop/806_final/otu_data1.csv", stringsAsFactors = TRUE)

rel_abun <- read.csv("C:/Users/megan/Desktop/806_final/rel_abun1.csv", stringsAsFactors = TRUE)

```

```{r, echo = FALSE}
library(dplyr)
library(tidyr)
```

```{r, echo = FALSE}

comb1 <- inner_join(otu_data, rel_abun, by = "OTU")
comb2 <- inner_join(sup_data, lake_data)
database <- inner_join(comb1, comb2)


```

```{r, echo = FALSE}

library(ggplot2)
select(database, Lake, Phylum, value, pH) %>%
  filter(Lake == "Crystal Bog", pH > 0) %>% 
  ggplot(mapping = aes(fill = Phylum, x = pH, y = value, color = Phylum))
 + geom_bar(position="stack", stat="identity") + labs(x = "pH", y = "Abundance")

```

# this plot shows abundance of microbes varying by pH in Crystal Bog
```{r, echo = FALSE}

select(database, Lake, Phylum, value, pH) %>%
  filter(Lake == "Crystal Bog", pH > 0) %>% 
  ggplot(mapping = aes(x = pH, y = value)) + geom_bar(stat="identity") + labs(
    x = "pH", y = "Abundance")

```

```{r, echo = FALSE}

select(database, Lake, Phylum, value, pH) %>%
  filter(Lake == "Trout Bog", pH > 0) %>% 
  ggplot(mapping = aes(x = pH, y = value)) + geom_bar(stat="identity") + labs(
    x = "pH", y = "Abundance")

```

```{r, echo = FALSE}

select(database, Lake, Temperature, Month, Year) %>%
  filter(Year == 2007, Temperature != "NA") %>% 
  ggplot(mapping = aes(x = Month, y = Temperature, color = Lake)) +
  geom_point() + geom_line()

```

```{r, echo = FALSE}

select(database, Month, Year, Temperature, Lake) %>%
  group_by(Lake, Month) %>%
  filter(Temperature > 0, Year == 2007) %>%
  summarize(mean_temp_month = mean(Temperature)) %>%
  ggplot(mapping = aes(x = Month, y = mean_temp_month, color = 
  Lake, by = Lake)) + geom_point() + geom_line() + labs(color = 
  "Lake", x = "Month", y = "Temperature (C)")

```